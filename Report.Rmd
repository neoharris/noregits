---
title: "Do individuals with ongoing health issues believe their condition will get worse while waiting for treatment?"
author: "NoRegits"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: flatly
    highlight: zenburn
    code_download: true
    code_folding: show
    toc: true
    toc_float: true
  pdf_document:
    toc: true
  word_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Cleaning

We were given 4 datasets which consisted of data around physical health, mental health, beliefs around health worsening, demographic data, and other information around health.

We started by loading the datasets into R, and examining them to understand the structure of the data.

```{r}

Pclean <- read.csv("P.csv")
Aclean <- read.csv("A.csv")
Bclean <- read.csv("B.csv")
Hclean <- read.csv("TaskData.csv") #You will need to use the name of your 'H' dataset here

```

```{r}

#It was clear that the H dataset has missing data compared to the other datasets, so we restructured this to make these easy to merge

Hclean$Region <- c("H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H", "H","H", "H", "H", "H", "H", "H")

Hclean$SES5 <- c("", "", "", "", "", "", "", "", "", "", "", "","", "", "", "", "", "")
Hclean$PH <- Hclean$Physical
Hclean$MH <-Hclean$Mental
Hclean <- Hclean[,c("Age", "Gender", "Smoker", "PH", "MH", "Belief", "SES5", "Region")]

View(Hclean)

Bclean <-read.csv("B.csv")

View(Pclean)
View(Aclean)
View(Bclean)
View(Hclean)

#Change all No values to N, Yes values to Y 
Pclean$PH[Pclean$PH %in% c("No")]="N"
Pclean$PH[Pclean$PH %in% c("Yes")]="Y"

#Combining data 

total <- rbind(Hclean, Pclean, Aclean)
View(total)
```

## Descriptive Analysis

## Primary Task

### Conduct a binomial regression (hint: glm() function) to assess whether individuals with on-going health issues believe their condition will get worse while waiting for treatment.

```{r}
# Coding ongoing health issues as 0 or 1 based on presence of physical or mental health issues coded
total$PH = ifelse(total$PH=="Y", 1,0)
total$MH = ifelse(total$MH=="Y", 1,0)
total$HI = total$PH + total$MH
total$HI = ifelse(total$HI==0, 1,0)
total$HI= as.factor(total$HI)
total$Belief = ifelse(total$Belief=="Y", 1,0)
total$Belief = as.factor(total$Belief)

```

```{r}

# Performing logistic regression model on health outcomes as a function of belief

binreg = glm(Belief ~ HI, data = total, family=binomial(link="logit"))
summary(binreg)
```

## Secondary Task

```{r}

#Secondary analysis: assess the prevalence of health issues in the cohort 
table1<- xtabs(~MH, total) #Prevalence of MH 
table2 <- xtabs(~PH, total) #Prevalence of PH 
print(table1) 
print(table2)

#Adjust for other factors
smoking <- xtabs(~MH+Smoker, total)
p_smoking <- prop.table(smoking)
print(p_smoking)

library(esquisse)
esquisser(total)

```
